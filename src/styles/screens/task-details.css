/* Screens: Task Details (and Features list) */
.task-details { background: var(--surface-base); color: var(--text-primary); }
.details-header { border-bottom: 1px solid var(--border-subtle); background: var(--surface-base); }
.details-header__bar { display:flex; align-items:center; gap: 10px; padding: 10px 12px; }
.details-title { margin: 0; font-size: var(--fs-xl, 20px); line-height: var(--lh-tight, 1.1); font-weight: var(--fw-semibold, 600); }
.details-header__bar .spacer { flex: 1 1 auto; }
.details-header__meta { display:flex; gap: 16px; align-items:center; padding: 0 12px 10px; color: var(--text-secondary); font-size: var(--fs-xs, 12px); }
.meta-item { display:inline-flex; gap: 6px; align-items:center; }
.meta-label { color: var(--text-muted); }

.details-content { padding: 12px; }
.panel { background: var(--surface-raised); border: 1px solid var(--border-default); border-radius: var(--radius-3); box-shadow: var(--shadow-0); padding: 12px; }
.panel + .panel { margin-top: 12px; }
.section-header { display:flex; align-items:center; gap: 8px; margin-bottom: 8px; }
.section-header .section-title { margin: 0; font-size: var(--fs-lg, 18px); }
.section-header .section-actions { margin-left: auto; display:flex; gap: 8px; }
.section-title { margin: 0 0 8px; font-size: var(--fs-lg, 18px); }
.task-desc { color: var(--text-primary); }

.features-list { list-style: none; padding: 0; margin: 0; }
/* Compact ID and Actions columns using max-content; shrink Status and bias more width to Dependencies */
.features-head { display:grid; grid-template-columns: 0.1fr 1.2fr max-content 1.2fr max-content; gap: 20px; padding: 8px; color: var(--text-muted); border-bottom: 1px solid var(--border-subtle); }
.feature-item + .feature-item { border-top: 1px solid var(--border-subtle); }
.feature-row { display:grid; grid-template-columns: 0.1fr 1.3fr max-content 1.2fr max-content; gap: 20px; align-items:center; padding: 8px; }
.feature-row:hover { background: color-mix(in srgb, var(--surface-raised) 95%, var(--text-primary) 5%); }
.feature-row.draggable { cursor: grab; }
.feature-row:focus { outline: none; box-shadow: 0 0 0 var(--focus-ring-width) color-mix(in srgb, var(--focus-ring) 45%, transparent) inset; }
.col { min-width: 0; }
.col-title { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.col-status { white-space: nowrap; }
.col-actions { display:flex; align-items:center; gap: 8px; justify-content: flex-end; }
.row-actions { display:inline-flex; gap: 6px; opacity: 0; pointer-events: none; transition: opacity var(--motion-fast, 120ms) var(--easing-standard, ease); }
.feature-row:hover .row-actions, .feature-row:focus .row-actions { opacity: 1; pointer-events: auto; }

/* Dependencies visualization */
.deps-list { display:flex; align-items:center; gap: 6px; flex-wrap: wrap; }
.deps-sub { display:flex; align-items:center; gap: 6px; margin-top: 4px; }
.deps-sub__label { font-size: var(--fs-xxs, 10px); color: var(--text-muted); padding: 2px 6px; border-radius: var(--radius-round); border: 1px solid var(--border-subtle); }
.dep-chip { display:inline-flex; align-items:center; gap: 4px; padding: 2px 8px; border-radius: var(--radius-round); font-size: var(--fs-xxs, 10px); border: 1px solid var(--border-default); background: var(--surface-base); color: var(--text-secondary); }
.dep-chip--ok { background: color-mix(in srgb, var(--status-review-soft-bg) 42%, transparent); border-color: var(--status-review-soft-border); color: var(--text-primary); }
.dep-chip--missing { background: color-mix(in srgb, var(--status-stuck-soft-bg) 42%, transparent); border-color: var(--status-stuck-soft-border); color: var(--text-primary); }
.dep-chip--blocks { background: color-mix(in srgb, var(--status-working-soft-bg) 36%, transparent); border-color: var(--status-working-soft-border); color: var(--text-primary); }
.dep-chip--none { opacity: 0.7; }

.empty { padding: 12px; color: var(--text-secondary); }

@media (max-width: 900px) {
  /* Keep Status compact and still bias more room to Dependencies on smaller screens */
  .features-head, .feature-row { grid-template-columns: max-content 0.9fr max-content 1.1fr max-content; }
}

/* DnD: Match tasks list cues and animations for features */
.task-details .features-list { position: relative; }
.task-details .features-list.dnd-active { user-select: none; }
.task-details .feature-row {
  transition:
    transform var(--motion-fast, 120ms) var(--easing-decelerate, ease-out),
    background-color var(--motion-fast, 120ms) ease,
    box-shadow var(--motion-fast, 120ms) ease;
  background: transparent;
}
.task-details .feature-row.draggable { cursor: grab; }
.task-details .feature-row.is-dragging { cursor: grabbing; opacity: 0.6; transform: scale(0.98); box-shadow: var(--shadow-1); }
.task-details .feature-row.is-drop-target { background: color-mix(in srgb, var(--accent-primary) 8%, transparent); }
.task-details .drop-indicator { height: 6px; margin: 6px 8px; border-radius: 6px; background: linear-gradient(90deg, var(--accent-primary), color-mix(in srgb, var(--accent-primary) 70%, var(--color-blue-650, var(--accent-primary)))); box-shadow: 0 0 0 2px color-mix(in srgb, var(--accent-primary) 28%, transparent), 0 4px 10px -2px color-mix(in srgb, var(--accent-primary) 40%, transparent); transform-origin: center; transform: scaleX(0.85); animation: dropPulse var(--motion-normal, 160ms) var(--easing-decelerate, ease-out) forwards; }
@keyframes dropPulse { from { transform: scaleX(0.6); opacity: 0.5; } to { transform: scaleX(1); opacity: 1; } }
.task-details .features-list::after { content: ''; display:block; height: 16px; }

.rejection-badge {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 20px;
  height: 20px;
  border-radius: var(--radius-round);
  background: var(--status-stuck-bg);
  color: var(--status-stuck-fg);
}
