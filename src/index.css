@import './styles/design-tokens.css';

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Root layout: make the app fill the window and avoid unexpected margins */
html, body, #root { height: 100%; }
html, body { margin: 0; padding: 0; }

/* Base body colors using semantic tokens */
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  color: var(--text-primary);
  background: var(--surface-base);
}

h1, h2, h3 { color: var(--accent-primary); }

/* Buttons */
button, .btn {
  background: var(--accent-primary);
  color: var(--text-inverted);
  border: none;
  padding: 0.5rem 1rem;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
}
button:hover, .btn:hover { background: var(--accent-primary-hover); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
button:active, .btn:active { background: var(--accent-primary-active); }

.btn-secondary { background: var(--surface-raised); color: var(--text-primary); border: 1px solid var(--border-default); }
.btn-secondary:hover { background: color-mix(in srgb, var(--surface-raised) 92%, var(--surface-base)); }

/* Tasks view */
#tasks-view { margin: 1rem 0 2rem 0; background: var(--surface-base); padding: 1rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); }
.tasks-controls { display: grid; grid-template-columns: 1fr 220px auto; gap: 0.75rem; align-items: end; margin-bottom: 0.5rem; }
.tasks-controls .control label { display: block; font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 0.25rem; }
.tasks-controls input[type="search"], .tasks-controls select { width: 100%; padding: 0.5rem 0.6rem; border: 1px solid var(--border-default); border-radius: 6px; font-size: 0.95rem; transition: all 0.2s ease; background: var(--surface-raised); color: var(--text-primary); }
.tasks-controls input[type="search"]:focus, .tasks-controls select:focus { border-color: var(--border-focus); box-shadow: 0 0 0 3px color-mix(in srgb, var(--focus-ring) 30%, transparent); }
.tasks-controls .control-buttons { display: flex; }
.btn-clear { padding: 0.5rem 0.75rem; border: 1px solid var(--border-default); border-radius: 6px; background: var(--surface-raised); cursor: pointer; color: var(--text-primary); }
.btn-clear:hover { background: color-mix(in srgb, var(--surface-raised) 92%, var(--surface-base)); }
.tasks-count { font-size: 0.9rem; color: var(--text-muted); margin: 0.25rem 0 0.75rem 0; }
.tasks-results .empty { padding: 1rem; background: var(--surface-raised); border: 1px dashed var(--border-subtle); border-radius: 6px; color: var(--text-secondary); }
.tasks-list { list-style: none; padding: 0; margin: 0; }
.task-item + .task-item { margin-top: 6px; }
.task-row { display: grid; grid-template-columns: 80px 1fr 160px 120px; gap: 0.5rem 1rem; align-items: center; padding: 0.6rem 0.75rem; border: 1px solid var(--border-default); border-radius: 8px; background: var(--surface-raised); outline: none; transition: all 0.2s ease; }
.task-row:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
.task-row:focus { box-shadow: 0 0 0 3px color-mix(in srgb, var(--focus-ring) 38%, transparent); border-color: var(--border-focus); }
.col-id { font-variant-numeric: tabular-nums; color: var(--text-primary); font-weight: 600; }
.col-title { overflow: hidden; white-space: nowrap; text-overflow: ellipsis; }
.col-status { text-align: left; }
.col-features { text-align: left; color: var(--text-primary); }
.status-badge { display: inline-block; padding: 0.15rem 0.5rem; border-radius: 999px; font-size: 0.8rem; line-height: 1.2; border: 1px solid transparent; }

/* Map legacy status classes to tokenized soft variants for accessibility */
.status-done { background: var(--status-done-soft-bg); color: var(--status-done-soft-fg); border-color: var(--status-done-soft-border); }
.status-inprogress { background: var(--status-review-soft-bg); color: var(--status-review-soft-fg); border-color: var(--status-review-soft-border); }
.status-pending { background: var(--status-queued-soft-bg); color: var(--status-queued-soft-fg); border-color: var(--status-queued-soft-border); }
.status-blocked { background: color-mix(in srgb, var(--status-blocked-bg) 14%, transparent); color: #FFDEE0; border-color: color-mix(in srgb, var(--status-blocked-bg) 60%, transparent); }
.status-deferred { background: var(--status-working-soft-bg); color: var(--status-working-soft-fg); border-color: var(--status-working-soft-border); }

/* Features (Task Details) */
#task-details-view { margin: 1rem 0 2rem 0; background: var(--surface-base); padding: 1rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.08); }
.features-list { list-style: none; padding: 0; margin: 0; }
.feature-item + .feature-item { margin-top: 8px; }
.feature-row { display: grid; grid-template-columns: 80px 1fr 160px 120px; gap: 0.5rem 1rem; align-items: start; padding: 0.6rem 0.75rem; border: 1px solid var(--border-default); border-radius: 8px; background: var(--surface-raised); transition: all 0.2s ease; }
.feature-row:hover { box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
.feature-row.editing { grid-template-columns: 80px 1fr; }
.col-actions { text-align: right; }
.feature-edit-form .form-row { display: grid; grid-template-columns: 140px 1fr; gap: 0.5rem; align-items: center; margin-bottom: 0.5rem; }
.feature-edit-form .form-actions { display: flex; gap: 0.5rem; align-items: center; }
.feature-edit-form label { color: var(--text-secondary); font-size: 0.9rem; }
.feature-edit-form input[type="text"], .feature-edit-form textarea, .feature-edit-form select { width: 100%; padding: 0.5rem 0.6rem; border: 1px solid var(--border-default); border-radius: 6px; font-size: 0.95rem; transition: all 0.2s ease; background: var(--surface-raised); color: var(--text-primary); }
.feature-edit-form input:focus, .feature-edit-form textarea:focus, .feature-edit-form select:focus { border-color: var(--border-focus); box-shadow: 0 0 0 3px color-mix(in srgb, var(--focus-ring) 30%, transparent); }
.btn-edit, .btn-save, .btn-cancel, .btn-back, .btn-add-row, .btn-remove-row { padding: 0.45rem 0.75rem; border-radius: 6px; cursor: pointer; transition: all 0.2s ease; }
.btn-edit, .btn-save { background: var(--accent-primary); color: var(--text-inverted); border: none; }
.btn-cancel, .btn-back, .btn-add-row, .btn-remove-row { background: var(--surface-raised); border: 1px solid var(--border-default); color: var(--text-primary); }
.btn-edit:hover, .btn-save:hover { background: var(--accent-primary-hover); }
.btn-cancel:hover, .btn-back:hover, .btn-add-row:hover, .btn-remove-row:hover { background: color-mix(in srgb, var(--surface-raised) 92%, var(--surface-base)); }
.task-meta { margin: 0.5rem 0 1rem; }
.task-meta .task-title { display: flex; gap: 0.5rem; align-items: center; }
.task-meta .task-desc { margin-top: 0.25rem; color: var(--text-secondary); }

/* String list editor */
.string-list { width: 100%; }
.string-list-rows { list-style: none; padding: 0; margin: 0 0 0.5rem 0; }
.string-list-row { display: flex; gap: 0.5rem; align-items: center; margin-bottom: 0.4rem; }
.string-list-row input[type="text"] { flex: 1 1 auto; }

/* Popup styles */
.container { padding: 2rem; max-width: 40rem; margin: auto; }
.form-group { margin-bottom: 1rem; }
.form-group label { display: block; margin-bottom: 0.5rem; font-weight: 500; color: var(--text-secondary); }
.form-group input, .form-group textarea, .form-group select { width: 100%; padding: 0.5rem; border: 1px solid var(--border-default); border-radius: 6px; transition: all 0.2s ease; background: var(--surface-raised); color: var(--text-primary); }
.form-group input:focus, .form-group textarea:focus, .form-group select:focus { border-color: var(--border-focus); box-shadow: 0 0 0 3px color-mix(in srgb, var(--focus-ring) 30%, transparent); }
.form-actions { display: flex; justify-content: flex-end; gap: 1rem; }

/* Responsive tweaks */
@media (max-width: 720px) {
  .tasks-controls { grid-template-columns: 1fr; }
  .task-row { grid-template-columns: 70px 1fr; }
  .col-status, .col-features { margin-left: 70px; }
  .feature-row { grid-template-columns: 70px 1fr; }
  .feature-row.editing { grid-template-columns: 70px 1fr; }
  .feature-edit-form .form-row { grid-template-columns: 1fr; }
}
